<!doctype html>
<html lang="ko">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ê·€ì—¬ìš´ ë°œí‘œ íƒ€ì´ë¨¸</title>
  <style>
    :root {
      --bg1: #fff7ed;
      /* warm cream */
      --bg2: #ecfeff;
      /* soft mint */
      --card: #ffffffcc;
      --cardBorder: #ffffff;
      --text: #1f2937;
      --muted: #6b7280;
      --accent: #fb7185;
      /* coral-pink */
      --accent2: #60a5fa;
      /* sky */
      --shadow: 0 18px 45px rgba(31, 41, 55, .12);
      --radius: 26px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans KR", "Apple SD Gothic Neo", "Malgun Gothic", Arial, "Helvetica Neue", Helvetica, sans-serif;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      min-height: 100vh;
      font-family: var(--sans);
      color: var(--text);
      background:
        radial-gradient(900px 500px at 10% 10%, #ffe4e6, transparent 55%),
        radial-gradient(850px 520px at 90% 20%, #dbeafe, transparent 55%),
        radial-gradient(900px 600px at 50% 100%, #dcfce7, transparent 60%),
        linear-gradient(135deg, var(--bg1), var(--bg2));
      overflow-x: hidden;
    }

    /* cute doodles */
    body::before {
      content: "";
      position: fixed;
      inset: 0;
      pointer-events: none;
      opacity: .28;
      background-image:
        radial-gradient(circle at 18px 18px, rgba(251, 113, 133, .35) 2px, transparent 3px),
        radial-gradient(circle at 12px 12px, rgba(96, 165, 250, .30) 2px, transparent 3px),
        radial-gradient(circle at 22px 28px, rgba(34, 197, 94, .25) 2px, transparent 3px);
      background-size: 64px 64px;
    }

    .wrap {
      max-width: 980px;
      margin: 0 auto;
      padding: 26px 18px 34px;
    }

    header {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: 14px;
      margin: 6px 0 16px;
    }

    .title h1 {
      margin: 0;
      font-size: 22px;
      font-weight: 900;
      letter-spacing: .2px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .title h1 .emoji {
      display: inline-flex;
      width: 38px;
      height: 38px;
      align-items: center;
      justify-content: center;
      border-radius: 14px;
      background: #fff;
      box-shadow: 0 12px 30px rgba(31, 41, 55, .10);
      border: 2px solid #fff;
    }

    .title p {
      margin: 6px 0 0;
      font-size: 13px;
      color: var(--muted);
      line-height: 1.45;
    }

    .chip {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 10px 12px;
      border-radius: 999px;
      background: #ffffffcc;
      border: 2px solid #fff;
      box-shadow: 0 12px 30px rgba(31, 41, 55, .10);
      user-select: none;
      font-weight: 800;
      font-size: 12px;
      color: #374151;
    }

    .dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: var(--accent2);
      box-shadow: 0 0 0 6px rgba(96, 165, 250, .22);
    }

    .grid {
      display: grid;
      grid-template-columns: 1.2fr .8fr;
      gap: 16px;
    }

    @media (max-width: 860px) {
      .grid {
        grid-template-columns: 1fr;
      }
    }

    .card {
      border-radius: var(--radius);
      background: var(--card);
      border: 2px solid var(--cardBorder);
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      overflow: hidden;
      position: relative;
    }

    .inner {
      padding: 18px;
    }

    .timerFace {
      border-radius: 22px;
      padding: 18px 16px;
      background: #ffffffd9;
      border: 2px dashed rgba(251, 113, 133, .35);
      box-shadow: inset 0 0 0 1px rgba(31, 41, 55, .05);
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
    }

    .time {
      font-family: var(--mono);
      font-weight: 950;
      font-size: clamp(56px, 7.5vw, 96px);
      letter-spacing: 1px;
      line-height: 1;
      color: #111827;
    }

    .subline {
      margin-top: 12px;
      display: flex;
      gap: 10px;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
      color: var(--muted);
      font-size: 13px;
      font-weight: 700;
    }

    .subline b {
      color: #111827;
      font-weight: 900;
    }

    .progress {
      margin-top: 14px;
      height: 12px;
      border-radius: 999px;
      background: rgba(31, 41, 55, .06);
      border: 2px solid rgba(255, 255, 255, .9);
      overflow: hidden;
    }

    .bar {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, rgba(251, 113, 133, .95), rgba(96, 165, 250, .9));
      border-radius: 999px;
      transition: width 200ms linear;
    }

    .controls {
      margin-top: 14px;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }

    button {
      appearance: none;
      border: 2px solid #fff;
      background: #ffffffcc;
      color: #111827;
      padding: 12px 13px;
      border-radius: 16px;
      font-weight: 900;
      letter-spacing: .1px;
      cursor: pointer;
      transition: transform .08s ease, filter .2s ease;
      user-select: none;
      box-shadow: 0 12px 26px rgba(31, 41, 55, .10);
    }

    button:hover {
      filter: brightness(1.03);
    }

    button:active {
      transform: translateY(1px);
    }

    .primary {
      background: linear-gradient(135deg, rgba(251, 113, 133, .35), rgba(96, 165, 250, .22));
      border-color: #fff;
    }

    .danger {
      background: rgba(251, 113, 133, .14);
    }

    .mini {
      padding: 10px 12px;
      font-size: 13px;
      border-radius: 14px;
    }

    .panelTitle {
      font-size: 14px;
      margin: 0 0 10px;
      color: #374151;
      letter-spacing: .2px;
      font-weight: 950;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .panelTitle .tag {
      font-size: 12px;
      font-weight: 900;
      color: #111827;
      background: rgba(34, 197, 94, .15);
      border: 2px solid #fff;
      padding: 4px 8px;
      border-radius: 999px;
    }

    .row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-bottom: 12px;
    }

    .row3 {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 10px;
      margin-top: 10px;
    }

    @media (max-width: 520px) {
      .row {
        grid-template-columns: 1fr;
      }

      .row3 {
        grid-template-columns: 1fr;
      }
    }

    label {
      display: block;
      font-size: 12px;
      color: #374151;
      margin-bottom: 8px;
      font-weight: 950;
    }

    input,
    select {
      width: 100%;
      padding: 12px 12px;
      border-radius: 16px;
      border: 2px solid #fff;
      background: #ffffffd9;
      color: #111827;
      outline: none;
      box-shadow: 0 12px 26px rgba(31, 41, 55, .08);
    }

    input:focus,
    select:focus {
      border-color: rgba(96, 165, 250, .9);
    }

    .hint {
      font-size: 12px;
      color: #6b7280;
      line-height: 1.5;
      margin-top: 6px;
      font-weight: 700;
    }

    .footerNote {
      margin-top: 14px;
      color: #6b7280;
      font-size: 12px;
      line-height: 1.6;
      font-weight: 700;
    }

    .kbd {
      font-family: var(--mono);
      font-weight: 950;
      background: rgba(31, 41, 55, .06);
      border: 2px solid #fff;
      padding: 2px 6px;
      border-radius: 10px;
      margin: 0 2px;
      color: #111827;
      font-size: 12px;
    }

    .flash {
      animation: flash 260ms steps(2) infinite;
    }

    @keyframes flash {
      0% {
        filter: brightness(1);
      }

      50% {
        filter: brightness(1.12);
      }

      100% {
        filter: brightness(1);
      }
    }

    .toast {
      position: fixed;
      left: 50%;
      bottom: 20px;
      transform: translateX(-50%);
      background: rgba(255, 255, 255, .92);
      border: 2px solid #fff;
      color: #111827;
      padding: 10px 12px;
      border-radius: 999px;
      font-size: 13px;
      box-shadow: 0 18px 45px rgba(31, 41, 55, .12);
      opacity: 0;
      pointer-events: none;
      transition: opacity .25s ease, transform .25s ease;
      max-width: min(90vw, 680px);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      font-weight: 900;
    }

    .toast.show {
      opacity: 1;
      transform: translateX(-50%) translateY(-6px);
    }

    .home-btn {
      position: fixed;
      top: 10px;
      left: 10px;
      background: white;
      padding: 8px 16px;
      border-radius: 20px;
      text-decoration: none;
      color: #5D4037;
      font-family: var(--sans);
      box-shadow: 0 5px 0 rgba(0, 0, 0, 0.1);
      z-index: 2000;
      border: 2px solid #FF8FB1;
      font-weight: bold;
      font-size: 14px;
    }

    .home-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 0 rgba(0, 0, 0, 0.1);
    }
  </style>
</head>

<body>
  <a href="index.html" class="home-btn">ğŸ  í™ˆìœ¼ë¡œ</a>

  <div class="wrap">
    <header>
      <div class="title">
        <h1><span class="emoji">â±ï¸</span>ê·€ì—¬ìš´ ë°œí‘œ íƒ€ì´ë¨¸</h1>
        <p>ì´ˆë“± ìˆ˜ì—… ë°œí‘œìš© Â· ë¶„/ì´ˆ ì„¤ì • Â· ë‹¨ì¶•í‚¤ ì§€ì›</p>
      </div>
      <div class="chip" title="ìƒíƒœ">
        <div class="dot" id="statusDot"></div>
        <span id="statusText">ì¤€ë¹„!</span>
      </div>
    </header>

    <div class="grid">
      <!-- Left -->
      <section class="card">
        <div class="inner">
          <div class="timerFace" id="timerFace">
            <div class="time" id="timeText">05:00</div>
          </div>

          <div class="subline">
            <div>ë‚¨ì€ ì‹œê°„: <b id="remainingLabel">5ë¶„ 0ì´ˆ</b></div>
            <div>ì˜¤ëŠ˜ë„ íŒŒì´íŒ…! ğŸŒˆ</div>
          </div>

          <div class="progress" aria-label="progress">
            <div class="bar" id="bar"></div>
          </div>

          <div class="controls">
            <button class="primary" id="startPauseBtn">ì‹œì‘</button>
            <button id="resetBtn">ë¦¬ì…‹</button>
            <button class="mini" id="minus10Btn">-10ì´ˆ</button>
            <button class="mini" id="plus10Btn">+10ì´ˆ</button>
            <button class="mini" id="fullscreenBtn">ì „ì²´í™”ë©´</button>
            <button class="mini danger" id="stopAlarmBtn" title="ì•Œë¦¼ì´ ìš¸ë¦´ ë•Œ ì •ì§€">ì•Œë¦¼ ë„ê¸°</button>
          </div>

          <div class="footerNote">
            ë‹¨ì¶•í‚¤: <span class="kbd">Space</span> ì‹œì‘/ì¼ì‹œì •ì§€,
            <span class="kbd">R</span> ë¦¬ì…‹,
            <span class="kbd">â†‘</span> +10ì´ˆ,
            <span class="kbd">â†“</span> -10ì´ˆ,
            <span class="kbd">F</span> ì „ì²´í™”ë©´
          </div>
        </div>
      </section>

      <!-- Right -->
      <aside class="card">
        <div class="inner">
          <div class="panelTitle">ì„¤ì • <span class="tag">ì‰¬ì›Œìš”!</span></div>

          <div class="row">
            <div>
              <label for="minutes">ë¶„ (0~999)</label>
              <input id="minutes" type="number" min="0" max="999" value="5" />
            </div>
            <div>
              <label for="seconds">ì´ˆ (0~59)</label>
              <input id="seconds" type="number" min="0" max="59" value="0" />
            </div>
          </div>

          <div class="row">
            <div>
              <label for="mode">í‘œì‹œ í¬ê¸°</label>
              <select id="mode">
                <option value="mmss" selected>ê¸°ë³¸(MM:SS)</option>
                <option value="big">í° ìˆ«ì(ë©€ë¦¬ì„œ ë³´ê¸°)</option>
              </select>
              <div class="hint">ë°œí‘œí•  ë•Œ ì•„ì´ë“¤ì´ ë©€ë¦¬ì„œë„ ì˜ ë³´ì—¬ìš” ğŸ˜Š</div>
            </div>
            <div>
              <label for="endSound">ì¢…ë£Œ ì•Œë¦¼</label>
              <select id="endSound">
                <option value="on" selected>ì¼œê¸° ğŸ””</option>
                <option value="off">ë„ê¸° ğŸ¤«</option>
              </select>
              <div class="hint">ì¡°ìš©í•œ ìˆ˜ì—…ì´ë©´ ë„ê¸°ë¡œ!</div>
            </div>
          </div>

          <div class="row3">
            <button class="mini" id="applyBtn">ì‹œê°„ ì ìš©</button>
            <button class="mini" id="quick3">3ë¶„</button>
            <button class="mini" id="quick5">5ë¶„</button>
          </div>
          <div class="row3">
            <button class="mini" id="quick7">7ë¶„</button>
            <button class="mini" id="quick10">10ë¶„</button>
            <button class="mini" id="quick15">15ë¶„</button>
          </div>

          <div class="hint" style="margin-top:10px;">
            ğŸ”Š ì•Œë¦¼ìŒì€ ë¸Œë¼ìš°ì € ê·œì¹™ ë•Œë¬¸ì—, ë²„íŠ¼/í‚¤ë¥¼ í•œ ë²ˆ ëˆ„ë¥¸ ë’¤ë¶€í„° ì˜ ë‚˜ì™€ìš”.
          </div>
        </div>
      </aside>
    </div>
  </div>

  <div class="toast" id="toast">ì•Œë¦¼</div>

  <script>
    const el = (id) => document.getElementById(id);

    const timeText = el("timeText");
    const remainingLabel = el("remainingLabel");
    const bar = el("bar");

    const minutesInput = el("minutes");
    const secondsInput = el("seconds");
    const modeSelect = el("mode");
    const endSoundSelect = el("endSound");

    const startPauseBtn = el("startPauseBtn");
    const resetBtn = el("resetBtn");
    const applyBtn = el("applyBtn");

    const plus10Btn = el("plus10Btn");
    const minus10Btn = el("minus10Btn");

    const quick3 = el("quick3");
    const quick5 = el("quick5");
    const quick7 = el("quick7");
    const quick10 = el("quick10");
    const quick15 = el("quick15");

    const fullscreenBtn = el("fullscreenBtn");
    const stopAlarmBtn = el("stopAlarmBtn");

    const statusDot = el("statusDot");
    const statusText = el("statusText");
    const timerFace = el("timerFace");
    const toast = el("toast");

    // state
    let totalMs = 5 * 60 * 1000;
    let remainingMs = totalMs;
    let running = false;
    let tickHandle = null;
    let endTime = null;

    // alarm
    let alarmInterval = null;

    // WebAudio (simple beep)
    let audioUnlocked = false;
    let audioCtx = null;

    function unlockAudio() {
      if (audioUnlocked) return;
      audioUnlocked = true;
      try { audioCtx = new (window.AudioContext || window.webkitAudioContext)(); } catch (e) { }
    }

    function beep(duration = 0.10, freq = 880) {
      if (!audioCtx) return;
      const osc = audioCtx.createOscillator();
      const gain = audioCtx.createGain();
      osc.type = "sine";
      osc.frequency.value = freq;

      gain.gain.setValueAtTime(0.0001, audioCtx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.12, audioCtx.currentTime + 0.01);
      gain.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + duration);

      osc.connect(gain);
      gain.connect(audioCtx.destination);
      osc.start();
      osc.stop(audioCtx.currentTime + duration + 0.02);
    }

    function showToast(msg) {
      toast.textContent = msg;
      toast.classList.add("show");
      clearTimeout(showToast._t);
      showToast._t = setTimeout(() => toast.classList.remove("show"), 1600);
    }

    function clamp(n, min, max) { return Math.max(min, Math.min(max, n)); }

    function formatMMSS(ms) {
      const totalSec = Math.ceil(ms / 1000);
      const m = Math.floor(totalSec / 60);
      const s = totalSec % 60;
      return String(m).padStart(2, "0") + ":" + String(s).padStart(2, "0");
    }

    function humanLabel(ms) {
      const totalSec = Math.ceil(ms / 1000);
      const m = Math.floor(totalSec / 60);
      const s = totalSec % 60;
      return `${m}ë¶„ ${s}ì´ˆ`;
    }

    function setStatus(state) {
      if (state === "running") {
        statusText.textContent = "ì§„í–‰ ì¤‘ ğŸƒ";
        statusDot.style.background = "#22c55e";
      } else if (state === "paused") {
        statusText.textContent = "ì ê¹ ë©ˆì¶¤ âœ‹";
        statusDot.style.background = "#f59e0b";
      } else if (state === "done") {
        statusText.textContent = "ë! ğŸ‰";
        statusDot.style.background = "#fb7185";
      } else {
        statusText.textContent = "ì¤€ë¹„! ğŸ˜Š";
        statusDot.style.background = "#60a5fa";
      }
    }

    function updateUI() {
      const mode = modeSelect.value;
      timeText.style.fontSize = (mode === "big")
        ? "clamp(76px, 10vw, 130px)"
        : "clamp(56px, 7.5vw, 96px)";

      timeText.textContent = formatMMSS(remainingMs);
      remainingLabel.textContent = humanLabel(remainingMs);

      const pct = totalMs <= 0 ? 0 : (remainingMs / totalMs) * 100;
      bar.style.width = clamp(pct, 0, 100) + "%";

      startPauseBtn.textContent = running ? "ì¼ì‹œì •ì§€" : "ì‹œì‘";
    }

    function applyFromInputs() {
      const m = clamp(parseInt(minutesInput.value || "0", 10), 0, 999);
      const s = clamp(parseInt(secondsInput.value || "0", 10), 0, 59);

      totalMs = (m * 60 + s) * 1000;
      remainingMs = totalMs;

      stop();
      setStatus("idle");
      timerFace.classList.remove("flash");
      updateUI();

      showToast(`ì‹œê°„ ì ìš©: ${m}ë¶„ ${s}ì´ˆ`);
    }

    function start() {
      if (totalMs <= 0) {
        showToast("ì‹œê°„ì„ 1ì´ˆ ì´ìƒìœ¼ë¡œ ì„¤ì •í•´ì¤˜ìš”!");
        return;
      }
      if (running) return;

      running = true;
      setStatus("running");
      timerFace.classList.remove("flash");
      clearAlarm();

      endTime = Date.now() + remainingMs;

      tickHandle = setInterval(() => {
        const now = Date.now();
        remainingMs = Math.max(0, endTime - now);

        if (remainingMs <= 0) {
          remainingMs = 0;
          updateUI();
          finish();
          return;
        }
        updateUI();
      }, 100);

      updateUI();
    }

    function pause() {
      if (!running) return;
      running = false;
      setStatus("paused");
      clearInterval(tickHandle);
      tickHandle = null;
      endTime = null;
      updateUI();
    }

    function stop() {
      running = false;
      clearInterval(tickHandle);
      tickHandle = null;
      endTime = null;
      clearAlarm();
      timerFace.classList.remove("flash");
      updateUI();
    }

    function reset() {
      stop();
      remainingMs = totalMs;
      setStatus("idle");
      updateUI();
      showToast("ë¦¬ì…‹ ì™„ë£Œ!");
    }

    function finish() {
      pause();
      setStatus("done");
      timerFace.classList.add("flash");
      showToast("ì‹œê°„ ë! ë°œí‘œ ì˜í–ˆì–´ìš”! ğŸ‰");

      if (endSoundSelect.value === "off") return;
      if (!audioCtx) return;

      let i = 0;
      alarmInterval = setInterval(() => {
        beep(0.10, i % 2 === 0 ? 880 : 740);
        i++;
      }, 320);
    }

    function clearAlarm() {
      if (alarmInterval) {
        clearInterval(alarmInterval);
        alarmInterval = null;
      }
    }

    function addSeconds(delta) {
      const maxMs = 999 * 60 * 1000 + 59 * 1000;
      remainingMs = clamp(remainingMs + delta * 1000, 0, maxMs);

      if (running && endTime) {
        endTime = Date.now() + remainingMs;
      }

      if (remainingMs > 0) {
        timerFace.classList.remove("flash");
        clearAlarm();
        setStatus(running ? "running" : "paused");
      }
      updateUI();
    }

    async function toggleFullscreen() {
      const doc = document;
      const docEl = document.documentElement;
      try {
        if (!doc.fullscreenElement) {
          await docEl.requestFullscreen();
          showToast("ì „ì²´í™”ë©´ ì¼°ì–´ìš”!");
        } else {
          await doc.exitFullscreen();
          showToast("ì „ì²´í™”ë©´ í•´ì œ!");
        }
      } catch (e) {
        showToast("ì „ì²´í™”ë©´ì´ ì•ˆ ë  ìˆ˜ë„ ìˆì–´ìš” ğŸ˜…");
      }
    }

    // unlock audio on first interaction
    function onUserInteract() {
      unlockAudio();
      if (audioCtx && audioCtx.state === "suspended") {
        audioCtx.resume().catch(() => { });
      }
      window.removeEventListener("pointerdown", onUserInteract);
      window.removeEventListener("keydown", onUserInteract);
    }
    window.addEventListener("pointerdown", onUserInteract, { once: true });
    window.addEventListener("keydown", onUserInteract, { once: true });

    // events
    startPauseBtn.addEventListener("click", () => {
      unlockAudio();
      if (!running) start(); else pause();
    });

    resetBtn.addEventListener("click", reset);
    applyBtn.addEventListener("click", applyFromInputs);

    plus10Btn.addEventListener("click", () => addSeconds(+10));
    minus10Btn.addEventListener("click", () => addSeconds(-10));

    quick3.addEventListener("click", () => { minutesInput.value = 3; secondsInput.value = 0; applyFromInputs(); });
    quick5.addEventListener("click", () => { minutesInput.value = 5; secondsInput.value = 0; applyFromInputs(); });
    quick7.addEventListener("click", () => { minutesInput.value = 7; secondsInput.value = 0; applyFromInputs(); });
    quick10.addEventListener("click", () => { minutesInput.value = 10; secondsInput.value = 0; applyFromInputs(); });
    quick15.addEventListener("click", () => { minutesInput.value = 15; secondsInput.value = 0; applyFromInputs(); });

    fullscreenBtn.addEventListener("click", toggleFullscreen);

    stopAlarmBtn.addEventListener("click", () => {
      timerFace.classList.remove("flash");
      clearAlarm();
      showToast("ì•Œë¦¼ì„ ê»ì–´ìš” ğŸ¤«");
    });

    modeSelect.addEventListener("change", updateUI);

    // shortcuts
    window.addEventListener("keydown", (e) => {
      const tag = (e.target && e.target.tagName) ? e.target.tagName.toLowerCase() : "";
      const typing = tag === "input" || tag === "select" || tag === "textarea";
      if (typing) return;

      if (e.code === "Space") {
        e.preventDefault();
        unlockAudio();
        if (!running) start(); else pause();
      } else if (e.key.toLowerCase() === "r") {
        reset();
      } else if (e.key === "ArrowUp") {
        addSeconds(+10);
      } else if (e.key === "ArrowDown") {
        addSeconds(-10);
      } else if (e.key.toLowerCase() === "f") {
        toggleFullscreen();
      }
    });

    // init
    setStatus("idle");
    updateUI();
  </script>
</body>

</html>